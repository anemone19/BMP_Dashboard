<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>3 The Data | BMP Dashboard Manual</title>
  <meta name="description" content="3 The Data | BMP Dashboard Manual" />
  <meta name="generator" content="bookdown 0.34 and GitBook 2.6.7" />

  <meta property="og:title" content="3 The Data | BMP Dashboard Manual" />
  <meta property="og:type" content="book" />
  
  
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="3 The Data | BMP Dashboard Manual" />
  
  
  

<meta name="author" content="Ané Cloete" />


<meta name="date" content="2023-10-12" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="files-within-folders-and-folders-within-files-and-more-files.html"/>
<link rel="next" href="ui.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">BMP Dashboard Manual</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Hi :)</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#owners"><i class="fa fa-check"></i><b>1.1</b> Owners</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="files-within-folders-and-folders-within-files-and-more-files.html"><a href="files-within-folders-and-folders-within-files-and-more-files.html"><i class="fa fa-check"></i><b>2</b> Files within folders and folders within files and more files</a>
<ul>
<li class="chapter" data-level="2.1" data-path="files-within-folders-and-folders-within-files-and-more-files.html"><a href="files-within-folders-and-folders-within-files-and-more-files.html#biodiversity-kpi-mapping-master"><i class="fa fa-check"></i><b>2.1</b> Biodiversity KPI mapping Master</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="files-within-folders-and-folders-within-files-and-more-files.html"><a href="files-within-folders-and-folders-within-files-and-more-files.html#biodiversity-survey-master"><i class="fa fa-check"></i><b>2.1.1</b> Biodiversity Survey Master</a></li>
<li class="chapter" data-level="2.1.2" data-path="files-within-folders-and-folders-within-files-and-more-files.html"><a href="files-within-folders-and-folders-within-files-and-more-files.html#team_data"><i class="fa fa-check"></i><b>2.1.2</b> Team_Data</a></li>
<li class="chapter" data-level="2.1.3" data-path="files-within-folders-and-folders-within-files-and-more-files.html"><a href="files-within-folders-and-folders-within-files-and-more-files.html#survey_photos"><i class="fa fa-check"></i><b>2.1.3</b> Survey_Photos</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="files-within-folders-and-folders-within-files-and-more-files.html"><a href="files-within-folders-and-folders-within-files-and-more-files.html#bmpdashboard"><i class="fa fa-check"></i><b>2.2</b> BMPDashboard</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="files-within-folders-and-folders-within-files-and-more-files.html"><a href="files-within-folders-and-folders-within-files-and-more-files.html#remotedatapullprepare.r"><i class="fa fa-check"></i><b>2.2.1</b> RemoteDataPullPrepare.R</a></li>
<li class="chapter" data-level="2.2.2" data-path="files-within-folders-and-folders-within-files-and-more-files.html"><a href="files-within-folders-and-folders-within-files-and-more-files.html#global.r-ui.r-and-server.r"><i class="fa fa-check"></i><b>2.2.2</b> global.R, ui.R and server.R</a></li>
<li class="chapter" data-level="2.2.3" data-path="files-within-folders-and-folders-within-files-and-more-files.html"><a href="files-within-folders-and-folders-within-files-and-more-files.html#tabitems"><i class="fa fa-check"></i><b>2.2.3</b> TabItems</a></li>
<li class="chapter" data-level="2.2.4" data-path="files-within-folders-and-folders-within-files-and-more-files.html"><a href="files-within-folders-and-folders-within-files-and-more-files.html#modules"><i class="fa fa-check"></i><b>2.2.4</b> Modules</a></li>
<li class="chapter" data-level="2.2.5" data-path="files-within-folders-and-folders-within-files-and-more-files.html"><a href="files-within-folders-and-folders-within-files-and-more-files.html#www"><i class="fa fa-check"></i><b>2.2.5</b> www</a></li>
<li class="chapter" data-level="2.2.6" data-path="files-within-folders-and-folders-within-files-and-more-files.html"><a href="files-within-folders-and-folders-within-files-and-more-files.html#readme.md"><i class="fa fa-check"></i><b>2.2.6</b> README.md</a></li>
<li class="chapter" data-level="2.2.7" data-path="files-within-folders-and-folders-within-files-and-more-files.html"><a href="files-within-folders-and-folders-within-files-and-more-files.html#packages.r"><i class="fa fa-check"></i><b>2.2.7</b> packages.R</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="the-data.html"><a href="the-data.html"><i class="fa fa-check"></i><b>3</b> The Data</a>
<ul>
<li class="chapter" data-level="3.1" data-path="the-data.html"><a href="the-data.html#setting-up-onedrive"><i class="fa fa-check"></i><b>3.1</b> Setting up OneDrive</a></li>
<li class="chapter" data-level="3.2" data-path="the-data.html"><a href="the-data.html#getting-the-data"><i class="fa fa-check"></i><b>3.2</b> Getting the data</a></li>
<li class="chapter" data-level="3.3" data-path="the-data.html"><a href="the-data.html#data-cleaning-and-preparation"><i class="fa fa-check"></i><b>3.3</b> Data cleaning and preparation</a></li>
<li class="chapter" data-level="3.4" data-path="the-data.html"><a href="the-data.html#pulling-photos-and-documents-from-onedrive"><i class="fa fa-check"></i><b>3.4</b> Pulling photos and documents from OneDrive</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="the-data.html"><a href="the-data.html#photos"><i class="fa fa-check"></i><b>3.4.1</b> Photos</a></li>
<li class="chapter" data-level="3.4.2" data-path="the-data.html"><a href="the-data.html#documents"><i class="fa fa-check"></i><b>3.4.2</b> Documents</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="the-data.html"><a href="the-data.html#things-to-think-about"><i class="fa fa-check"></i><b>3.5</b> Things to think about</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="ui.html"><a href="ui.html"><i class="fa fa-check"></i><b>4</b> UI</a>
<ul>
<li class="chapter" data-level="4.1" data-path="ui.html"><a href="ui.html#ui.r"><i class="fa fa-check"></i><b>4.1</b> ui.R</a></li>
<li class="chapter" data-level="4.2" data-path="ui.html"><a href="ui.html#tabs"><i class="fa fa-check"></i><b>4.2</b> Tabs</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="ui.html"><a href="ui.html#tab_about"><i class="fa fa-check"></i><b>4.2.1</b> Tab_About</a></li>
<li class="chapter" data-level="4.2.2" data-path="ui.html"><a href="ui.html#tab_kpi"><i class="fa fa-check"></i><b>4.2.2</b> Tab_KPI</a></li>
<li class="chapter" data-level="4.2.3" data-path="ui.html"><a href="ui.html#tab_taxa_explorer"><i class="fa fa-check"></i><b>4.2.3</b> Tab_Taxa_Explorer</a></li>
<li class="chapter" data-level="4.2.4" data-path="ui.html"><a href="ui.html#tab_student_engagement"><i class="fa fa-check"></i><b>4.2.4</b> Tab_Student_Engagement</a></li>
<li class="chapter" data-level="4.2.5" data-path="ui.html"><a href="ui.html#tab_record_finder"><i class="fa fa-check"></i><b>4.2.5</b> Tab_Record_Finder</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="server.html"><a href="server.html"><i class="fa fa-check"></i><b>5</b> Server</a>
<ul>
<li class="chapter" data-level="5.1" data-path="server.html"><a href="server.html#setup"><i class="fa fa-check"></i><b>5.1</b> Setup</a></li>
<li class="chapter" data-level="5.2" data-path="server.html"><a href="server.html#valuebox-module"><i class="fa fa-check"></i><b>5.2</b> Valuebox Module</a></li>
<li class="chapter" data-level="5.3" data-path="server.html"><a href="server.html#tab-about"><i class="fa fa-check"></i><b>5.3</b> Tab About</a></li>
<li class="chapter" data-level="5.4" data-path="server.html"><a href="server.html#tab-kpi"><i class="fa fa-check"></i><b>5.4</b> Tab KPI</a></li>
<li class="chapter" data-level="5.5" data-path="server.html"><a href="server.html#tab-taxa-explorer"><i class="fa fa-check"></i><b>5.5</b> Tab Taxa Explorer</a></li>
<li class="chapter" data-level="5.6" data-path="server.html"><a href="server.html#tab-student-engagement"><i class="fa fa-check"></i><b>5.6</b> Tab Student Engagement</a></li>
<li class="chapter" data-level="5.7" data-path="server.html"><a href="server.html#tab-record-finder"><i class="fa fa-check"></i><b>5.7</b> Tab Record Finder</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="next-steps.html"><a href="next-steps.html"><i class="fa fa-check"></i><b>6</b> Next Steps</a>
<ul>
<li class="chapter" data-level="6.1" data-path="next-steps.html"><a href="next-steps.html#error-message-record-finder"><i class="fa fa-check"></i><b>6.1</b> Error message Record Finder</a></li>
<li class="chapter" data-level="6.2" data-path="next-steps.html"><a href="next-steps.html#different-years-different-data"><i class="fa fa-check"></i><b>6.2</b> Different years different data:</a></li>
<li class="chapter" data-level="6.3" data-path="next-steps.html"><a href="next-steps.html#data-download-and-clean-automation"><i class="fa fa-check"></i><b>6.3</b> Data download and clean automation:</a></li>
<li class="chapter" data-level="6.4" data-path="next-steps.html"><a href="next-steps.html#survey-photos"><i class="fa fa-check"></i><b>6.4</b> Survey Photos:</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="useful-things.html"><a href="useful-things.html"><i class="fa fa-check"></i><b>7</b> Useful things</a>
<ul>
<li class="chapter" data-level="7.1" data-path="useful-things.html"><a href="useful-things.html#reactive-expressions"><i class="fa fa-check"></i><b>7.1</b> Reactive Expressions</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="useful-things.html"><a href="useful-things.html#reactivity"><i class="fa fa-check"></i><b>7.1.1</b> 1. <strong>Reactivity:</strong></a></li>
<li class="chapter" data-level="7.1.2" data-path="useful-things.html"><a href="useful-things.html#understanding-reactive-expressions"><i class="fa fa-check"></i><b>7.1.2</b> 2. <strong>Understanding Reactive Expressions:</strong></a></li>
<li class="chapter" data-level="7.1.3" data-path="useful-things.html"><a href="useful-things.html#declaration-of-reactive-expressions"><i class="fa fa-check"></i><b>7.1.3</b> 3. <strong>Declaration of Reactive Expressions:</strong></a></li>
<li class="chapter" data-level="7.1.4" data-path="useful-things.html"><a href="useful-things.html#dependency-tracking"><i class="fa fa-check"></i><b>7.1.4</b> 4. <strong>Dependency Tracking:</strong></a></li>
<li class="chapter" data-level="7.1.5" data-path="useful-things.html"><a href="useful-things.html#use-in-output-elements"><i class="fa fa-check"></i><b>7.1.5</b> 5. <strong>Use in Output Elements:</strong></a></li>
<li class="chapter" data-level="7.1.6" data-path="useful-things.html"><a href="useful-things.html#reactivity-in-observe-and-eventreactive"><i class="fa fa-check"></i><b>7.1.6</b> 6. <strong>Reactivity in <code>observe()</code> and <code>eventReactive()</code>:</strong></a></li>
<li class="chapter" data-level="7.1.7" data-path="useful-things.html"><a href="useful-things.html#use-cases"><i class="fa fa-check"></i><b>7.1.7</b> 7. <strong>Use Cases:</strong></a></li>
<li class="chapter" data-level="7.1.8" data-path="useful-things.html"><a href="useful-things.html#performance-considerations"><i class="fa fa-check"></i><b>7.1.8</b> 8. <strong>Performance Considerations:</strong></a></li>
<li class="chapter" data-level="7.1.9" data-path="useful-things.html"><a href="useful-things.html#reactive-conductors"><i class="fa fa-check"></i><b>7.1.9</b> 9. <strong>Reactive Conductors:</strong></a></li>
<li class="chapter" data-level="7.1.10" data-path="useful-things.html"><a href="useful-things.html#isolation-of-reactivity"><i class="fa fa-check"></i><b>7.1.10</b> 10. <strong>Isolation of Reactivity:</strong></a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">BMP Dashboard Manual</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="the-data" class="section level1 hasAnchor" number="3">
<h1><span class="header-section-number">3</span> The Data<a href="the-data.html#the-data" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="setting-up-onedrive" class="section level2 hasAnchor" number="3.1">
<h2><span class="header-section-number">3.1</span> Setting up OneDrive<a href="the-data.html#setting-up-onedrive" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The following instructions are for Mac users. If you are using windows, you should have OneDrive already installed on your computer.</p>
<ol style="list-style-type: decimal">
<li><strong>Download OneDrive:</strong>
<ul>
<li>Go to the Mac App Store on your laptop.</li>
<li>Search for “OneDrive.”</li>
<li>Click on “Get” or “Install” to download the OneDrive app.</li>
</ul></li>
<li><strong>Install OneDrive:</strong>
<ul>
<li>Once downloaded, open your Applications folder and locate the OneDrive app.</li>
<li>Drag the OneDrive app to your Dock for easier access (optional).</li>
</ul></li>
<li><strong>Sign In:</strong>
<ul>
<li>Open the OneDrive app.</li>
<li>Sign in with your university account.</li>
<li>Follow the on-screen prompts to set up OneDrive.</li>
</ul></li>
<li><strong>Choose Folders to Sync:</strong>
<ul>
<li>Once signed in, you’ll have the option to choose which folders from your OneDrive cloud storage you want to sync with your Mac.</li>
<li>Select the folders you want or choose to sync everything.</li>
</ul></li>
<li><strong>Set OneDrive Preferences:</strong>
<ul>
<li>Click on the OneDrive icon in the Mac menu bar at the top of your screen.</li>
<li>Click on the three dots (More) and select “Preferences.”</li>
<li>Here, you can adjust settings like:
<ul>
<li>Starting OneDrive automatically when you sign in to your Mac.</li>
<li>Choosing how files are downloaded or uploaded (e.g., over metered networks).</li>
<li>Setting up file on-demand (allows you to see all your files without having them downloaded).</li>
</ul></li>
</ul></li>
<li><strong>Accessing Your Files:</strong></li>
</ol>
<ul>
<li>A OneDrive folder will now be present in your Mac’s Finder. This folder will sync with your online OneDrive storage. <span style="color: red; font-weight: bold"> Any files or folders you add to this folder will be automatically uploaded to the cloud, and any changes you make to files in this folder will be reflected in the cloud version.</span> Read that again! It important that you know that if you change or delete any files in the OneDrive folder on your laptop it will affect the database online.</li>
</ul>
<ol start="7" style="list-style-type: decimal">
<li><strong>To Unlink or Sign Out:</strong>
<ul>
<li>If you ever wish to unlink your account or sign out, click on the OneDrive icon in the Mac menu bar.</li>
<li>Click on the three dots (More) and select “Preferences.”</li>
<li>Go to the “Account” tab and select “Unlink this Mac.”</li>
</ul></li>
</ol>
</div>
<div id="getting-the-data" class="section level2 hasAnchor" number="3.2">
<h2><span class="header-section-number">3.2</span> Getting the data<a href="the-data.html#getting-the-data" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>First, navigate to the R script called “packages” to check whether you have all the required packages, if you don’t the script will also install and load them for you. Done!</p>
<p>Now, open the script “RemoteDataPull_Prepare”.</p>
<p>The most important first step here is to modify the object “path_to_master” with the filepath to where ever you have the OneDrive folder on your device and specifically to the main survey folder “Biodiversity Survey Master”. If you are using a Mac, navigate to the folder in Finder and then in the bottom panel (see below), right click the folder name and select “Copy”folder name” as Pathname”.</p>
<p><img src="images/pathname_copy.png" /></p>
<p>Let’s break down the code:</p>
<ol style="list-style-type: decimal">
<li><strong>Setting the Path to the Master Directory</strong>:</li>
</ol>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="the-data.html#cb1-1" tabindex="-1"></a>   path_to_master <span class="ot">&lt;-</span> <span class="st">&quot;/Users/anecloete/Library/CloudStorage/OneDrive-UniversityofStAndrews/Biodiversity KPI mapping Master&quot;</span></span></code></pre></div>
<p>This line sets a variable called <code>path_to_master</code> to the path of the main directory where the geopackage files are located. Paste the pathname you copied here.</p>
<ol start="2" style="list-style-type: decimal">
<li><strong>Obtaining All Geopackage Files</strong>:</li>
</ol>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="the-data.html#cb2-1" tabindex="-1"></a>all_gpkgs <span class="ot">&lt;-</span> <span class="fu">list.files</span>(</span>
<span id="cb2-2"><a href="the-data.html#cb2-2" tabindex="-1"></a>  <span class="at">path =</span> <span class="fu">paste0</span>(path_to_master,<span class="st">&quot;/Biodiversity Survey Master&quot;</span>),</span>
<span id="cb2-3"><a href="the-data.html#cb2-3" tabindex="-1"></a>  <span class="at">recursive =</span> <span class="cn">TRUE</span>,</span>
<span id="cb2-4"><a href="the-data.html#cb2-4" tabindex="-1"></a>  <span class="at">pattern =</span> <span class="st">&quot;</span><span class="sc">\\</span><span class="st">.gpkg$&quot;</span>,</span>
<span id="cb2-5"><a href="the-data.html#cb2-5" tabindex="-1"></a>  <span class="at">full.names =</span> <span class="cn">TRUE</span></span>
<span id="cb2-6"><a href="the-data.html#cb2-6" tabindex="-1"></a>)</span></code></pre></div>
<p>This code lists all files with the “.gpkg” extension in the specified directory and its subdirectories.
- The <code>path</code> argument specifies where to look.
- <code>recursive</code> set to <code>TRUE</code> means it will look in subdirectories as well.
- <code>pattern</code> filters for files ending with “.gpkg”.
- <code>full.names</code> set to <code>TRUE</code> ensures the full path of each file is returned, not just its name.</p>
<ol start="3" style="list-style-type: decimal">
<li><strong>Filtering Geopackages with ‘Habitat_Polygon’ in Their Name</strong>:</li>
</ol>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="the-data.html#cb3-1" tabindex="-1"></a>   survey_polygons <span class="ot">&lt;-</span> all_gpkgs[<span class="fu">grepl</span>(<span class="st">&quot;Habitat_Polygon&quot;</span>, all_gpkgs)]</span></code></pre></div>
<p>This filters the <code>all_gpkgs</code> vector for filenames that contain the substring “Habitat_Polygon” and assigns the subset to <code>survey_polygons</code>.</p>
<ol start="4" style="list-style-type: decimal">
<li><strong>Excluding Geopackages Based on Certain Keywords</strong>:</li>
</ol>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="the-data.html#cb4-1" tabindex="-1"></a>   pattern <span class="ot">&lt;-</span> <span class="st">&quot;Polygon|DESKTOP|PC|LAPTOP|Wills&quot;</span></span>
<span id="cb4-2"><a href="the-data.html#cb4-2" tabindex="-1"></a>   all_gpkgs <span class="ot">&lt;-</span> all_gpkgs[<span class="sc">!</span><span class="fu">grepl</span>(pattern, all_gpkgs)]</span></code></pre></div>
<p>Here, a pattern is defined to exclude geopackages with certain keywords in their names. The <code>grepl</code> function checks for matches, and the <code>!</code> operator negates the condition to exclude matches.</p>
<ol start="5" style="list-style-type: decimal">
<li><strong>Exclude a Specific Problematic Geopackage</strong>:</li>
</ol>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="the-data.html#cb5-1" tabindex="-1"></a>   problematic_gpkg <span class="ot">&lt;-</span> <span class="fu">paste0</span>(path_to_master,<span class="st">&quot;/Erica/Erica Backup/Ericabutterflies.gpkg&quot;</span>)</span>
<span id="cb5-2"><a href="the-data.html#cb5-2" tabindex="-1"></a>   all_gpkgs <span class="ot">&lt;-</span> all_gpkgs[all_gpkgs <span class="sc">!=</span> problematic_gpkg]</span></code></pre></div>
<p>This code defines a specific geopackage file path that is “problematic” and then removes this file from the <code>all_gpkgs</code> vector.</p>
<ol start="6" style="list-style-type: decimal">
<li><strong>Reading All Geopackages into a List</strong>:</li>
</ol>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="the-data.html#cb6-1" tabindex="-1"></a>myfiles <span class="ot">&lt;-</span> <span class="fu">lapply</span>(all_gpkgs, st_read)</span></code></pre></div>
<p>The <code>lapply</code> function is used here to apply the <code>st_read</code> function to each file path in the <code>all_gpkgs</code> vector. The result is a list, with each element being the content of a geopackage file stored as an spatial features dataframe. The <code>st_read</code> function is part of the <code>sf</code> package in R and is used to read spatial data.</p>
<p>In summary, this code:
- Sets a path to a master directory.
- Lists all geopackage files from this directory and its subdirectories.
- Filters and excludes certain geopackages based on keywords or specific filenames.
- Reads the content of each remaining geopackage file into a list.</p>
</div>
<div id="data-cleaning-and-preparation" class="section level2 hasAnchor" number="3.3">
<h2><span class="header-section-number">3.3</span> Data cleaning and preparation<a href="the-data.html#data-cleaning-and-preparation" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Most of this is self explanatory or is a bit tedious to explain. I would recommended investigating and exploring the data before the cleaning and preparation so that some of the lines make more sense. But here are a few notable things:</p>
<ul>
<li>Each student have a backup folder embedded in their folder, these geopackages are removed in line 72</li>
<li>There is separate geopackage for tree data collected, this is included in the dashboard so is cleaned separately and then joined to the rest.</li>
<li>The Species column contains the name of the species recorded, whether this is the scientific name, the common name or anything else. So all the naming columns are coalesced into one column called Species.</li>
<li>Line 135 was necessary because for some reason empty entries in the relevant columns were “” and not NA</li>
</ul>
<p>Some of the code could be a little less sausage making-ish and could be simplified (somethings were added after the fact etc), feel free to make it more efficient!</p>
<p><strong>SUMMARY</strong>:</p>
<ol style="list-style-type: decimal">
<li><strong>Coordinate Transformation</strong>:
<ul>
<li>Transforms the coordinate reference system of spatial data to standard latitude and longitude (EPSG:4326).</li>
</ul></li>
</ol>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="the-data.html#cb7-1" tabindex="-1"></a><span class="co"># Transform coordinate reference system from WGS 84 / Pseudo-Mercator to standard lat long (EPSG:4326)</span></span>
<span id="cb7-2"><a href="the-data.html#cb7-2" tabindex="-1"></a>taxa_dat <span class="ot">&lt;-</span> <span class="fu">lapply</span>(myfiles, <span class="cf">function</span>(x) <span class="fu">st_transform</span>(x, <span class="dv">4326</span>))</span></code></pre></div>
<ol start="2" style="list-style-type: decimal">
<li><strong>Data Conversions</strong>:
<ul>
<li>Converts the spatial data frames to regular data frames.</li>
<li>Names each data frame in the list based on the geopackage filename.</li>
<li>Removes duplicate data frames based on their names.</li>
</ul></li>
</ol>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="the-data.html#cb8-1" tabindex="-1"></a><span class="co"># Convert spatial data frames to regular data frames</span></span>
<span id="cb8-2"><a href="the-data.html#cb8-2" tabindex="-1"></a>taxa_dat <span class="ot">&lt;-</span> <span class="fu">lapply</span>(taxa_dat, as.data.frame)</span>
<span id="cb8-3"><a href="the-data.html#cb8-3" tabindex="-1"></a></span>
<span id="cb8-4"><a href="the-data.html#cb8-4" tabindex="-1"></a><span class="co"># Name each data frame in the list based on the geopackage filename</span></span>
<span id="cb8-5"><a href="the-data.html#cb8-5" tabindex="-1"></a><span class="fu">names</span>(taxa_dat) <span class="ot">&lt;-</span> <span class="fu">basename</span>(all_gpkgs)</span>
<span id="cb8-6"><a href="the-data.html#cb8-6" tabindex="-1"></a></span>
<span id="cb8-7"><a href="the-data.html#cb8-7" tabindex="-1"></a><span class="co"># Remove any duplicate data frames by name</span></span>
<span id="cb8-8"><a href="the-data.html#cb8-8" tabindex="-1"></a>taxa_dat <span class="ot">&lt;-</span> taxa_dat[<span class="sc">!</span><span class="fu">duplicated</span>(<span class="fu">names</span>(taxa_dat))]</span></code></pre></div>
<ol start="3" style="list-style-type: decimal">
<li><strong>Tree Entries Package Preparation</strong>:
<ul>
<li>Modifies columns for a specific geopackage (‘Tree Species Entries.gpkg’) to ensure compatibility with subsequent operations.</li>
<li>Cleans and modifies species names.</li>
<li>Sets certain columns to specific values or <code>NA</code>.</li>
<li>Filters and selects specific columns.</li>
</ul></li>
</ol>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="the-data.html#cb9-1" tabindex="-1"></a><span class="co"># Modify certain columns for &#39;Tree Species Entries.gpkg&#39; so that bind_rows works </span></span>
<span id="cb9-2"><a href="the-data.html#cb9-2" tabindex="-1"></a>taxa_dat<span class="sc">$</span><span class="st">`</span><span class="at">Tree Species Entries.gpkg</span><span class="st">`</span> <span class="ot">&lt;-</span> taxa_dat<span class="sc">$</span><span class="st">`</span><span class="at">Tree Species Entries.gpkg</span><span class="st">`</span> <span class="sc">%&gt;%</span></span>
<span id="cb9-3"><a href="the-data.html#cb9-3" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">Species =</span> <span class="dv">1</span>, <span class="at">Date =</span> <span class="dv">2</span>) <span class="sc">%&gt;%</span></span>
<span id="cb9-4"><a href="the-data.html#cb9-4" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb9-5"><a href="the-data.html#cb9-5" tabindex="-1"></a>    <span class="at">Species =</span> <span class="fu">case_when</span>(</span>
<span id="cb9-6"><a href="the-data.html#cb9-6" tabindex="-1"></a>      Species <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;unknown/other&quot;</span>, <span class="st">&quot;Unknown/other&quot;</span>) <span class="sc">~</span> comments.unlisted.species,</span>
<span id="cb9-7"><a href="the-data.html#cb9-7" tabindex="-1"></a>      Species <span class="sc">==</span> <span class="st">&quot;Unknown young pine &quot;</span> <span class="sc">~</span> <span class="st">&quot;Unknown young pine&quot;</span>,</span>
<span id="cb9-8"><a href="the-data.html#cb9-8" tabindex="-1"></a>      Species <span class="sc">==</span> <span class="st">&quot;Willow x10&quot;</span> <span class="sc">~</span> <span class="st">&quot;Willow&quot;</span>,</span>
<span id="cb9-9"><a href="the-data.html#cb9-9" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> Species</span>
<span id="cb9-10"><a href="the-data.html#cb9-10" tabindex="-1"></a>    ),</span>
<span id="cb9-11"><a href="the-data.html#cb9-11" tabindex="-1"></a>    <span class="at">taxa =</span> <span class="st">&quot;Vascular Plants&quot;</span>,</span>
<span id="cb9-12"><a href="the-data.html#cb9-12" tabindex="-1"></a>    <span class="at">Observer =</span> <span class="cn">NA</span>,</span>
<span id="cb9-13"><a href="the-data.html#cb9-13" tabindex="-1"></a>    <span class="at">photoid =</span> <span class="cn">NA</span>,</span>
<span id="cb9-14"><a href="the-data.html#cb9-14" tabindex="-1"></a>    <span class="at">Count =</span> <span class="cn">NA</span>,</span>
<span id="cb9-15"><a href="the-data.html#cb9-15" tabindex="-1"></a>    <span class="at">Other =</span> <span class="cn">NA</span>,</span>
<span id="cb9-16"><a href="the-data.html#cb9-16" tabindex="-1"></a>    <span class="at">Speciesful =</span> <span class="cn">NA</span></span>
<span id="cb9-17"><a href="the-data.html#cb9-17" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb9-18"><a href="the-data.html#cb9-18" tabindex="-1"></a>  <span class="fu">filter</span>(Species <span class="sc">!=</span> <span class="st">&quot;&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb9-19"><a href="the-data.html#cb9-19" tabindex="-1"></a>  <span class="fu">select</span>(Species, Date, taxa, Count)</span></code></pre></div>
<ol start="4" style="list-style-type: decimal">
<li><strong>Date Processing</strong>:
<ul>
<li>Converts, splits, and extracts components (year, month, day) of the ‘Date’ column.</li>
</ul></li>
</ol>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="the-data.html#cb10-1" tabindex="-1"></a><span class="co"># Date Processing: Convert, split and extract components of the &#39;Date&#39; column</span></span>
<span id="cb10-2"><a href="the-data.html#cb10-2" tabindex="-1"></a>taxa_dat <span class="ot">&lt;-</span> <span class="fu">lapply</span>(taxa_dat, <span class="cf">function</span>(df) {</span>
<span id="cb10-3"><a href="the-data.html#cb10-3" tabindex="-1"></a>  </span>
<span id="cb10-4"><a href="the-data.html#cb10-4" tabindex="-1"></a>  df<span class="sc">$</span>Date <span class="ot">&lt;-</span> <span class="fu">as.character</span>(df<span class="sc">$</span>Date)</span>
<span id="cb10-5"><a href="the-data.html#cb10-5" tabindex="-1"></a>  </span>
<span id="cb10-6"><a href="the-data.html#cb10-6" tabindex="-1"></a>  df <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb10-7"><a href="the-data.html#cb10-7" tabindex="-1"></a>    <span class="fu">separate</span>(Date, <span class="at">into =</span> <span class="fu">c</span>(<span class="st">&quot;date&quot;</span>, <span class="st">&quot;time&quot;</span>), <span class="at">sep =</span> <span class="st">&quot; (?=[^ ]+$)&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb10-8"><a href="the-data.html#cb10-8" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb10-9"><a href="the-data.html#cb10-9" tabindex="-1"></a>      <span class="at">date =</span> <span class="fu">ymd</span>(<span class="fu">gsub</span>(<span class="st">&quot;/&quot;</span>, <span class="st">&quot;-&quot;</span>, date)),</span>
<span id="cb10-10"><a href="the-data.html#cb10-10" tabindex="-1"></a>      <span class="at">year =</span> <span class="fu">year</span>(date),</span>
<span id="cb10-11"><a href="the-data.html#cb10-11" tabindex="-1"></a>      <span class="at">month =</span> <span class="fu">month</span>(date),</span>
<span id="cb10-12"><a href="the-data.html#cb10-12" tabindex="-1"></a>      <span class="at">day =</span> <span class="fu">day</span>(date)</span>
<span id="cb10-13"><a href="the-data.html#cb10-13" tabindex="-1"></a>    )</span>
<span id="cb10-14"><a href="the-data.html#cb10-14" tabindex="-1"></a>  <span class="fu">return</span>(df)</span>
<span id="cb10-15"><a href="the-data.html#cb10-15" tabindex="-1"></a>})</span></code></pre></div>
<ol start="5" style="list-style-type: decimal">
<li><strong>Tree Data Extraction</strong>:
<ul>
<li>Removes the tree data frame from the list and stores it separately.</li>
</ul></li>
</ol>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="the-data.html#cb11-1" tabindex="-1"></a><span class="co"># Extract and remove the tree dataframe from the list</span></span>
<span id="cb11-2"><a href="the-data.html#cb11-2" tabindex="-1"></a>tree_data <span class="ot">&lt;-</span> taxa_dat<span class="sc">$</span><span class="st">`</span><span class="at">Tree Species Entries.gpkg</span><span class="st">`</span></span>
<span id="cb11-3"><a href="the-data.html#cb11-3" tabindex="-1"></a>taxa_dat<span class="sc">$</span><span class="st">`</span><span class="at">Tree Species Entries.gpkg</span><span class="st">`</span> <span class="ot">&lt;-</span> <span class="cn">NULL</span></span></code></pre></div>
<ol start="6" style="list-style-type: decimal">
<li><strong>Combining Data</strong>:
<ul>
<li>Merges all data frames in the list into a single data frame.</li>
</ul></li>
</ol>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="the-data.html#cb12-1" tabindex="-1"></a><span class="co"># Combine all data frames in the list into a single data frame</span></span>
<span id="cb12-2"><a href="the-data.html#cb12-2" tabindex="-1"></a>taxa_comb <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(taxa_dat)</span></code></pre></div>
<ol start="7" style="list-style-type: decimal">
<li><strong>Data Cleaning and Transformation</strong>:
<ul>
<li>Performs several operations to clean and transform the combined data, including:
<ul>
<li>Date conversions and modifications.</li>
<li>Handling missing values.</li>
<li>Excluding certain records.</li>
<li>Recoding values in various columns.</li>
<li>Selecting and renaming columns.</li>
</ul></li>
</ul></li>
</ol>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="the-data.html#cb13-1" tabindex="-1"></a><span class="co"># Clean and transform taxa data for further analysis</span></span>
<span id="cb13-2"><a href="the-data.html#cb13-2" tabindex="-1"></a>taxa_clean <span class="ot">&lt;-</span> taxa_comb <span class="sc">%&gt;%</span></span>
<span id="cb13-3"><a href="the-data.html#cb13-3" tabindex="-1"></a>  <span class="fu">drop_na</span>(taxa) <span class="sc">%&gt;%</span></span>
<span id="cb13-4"><a href="the-data.html#cb13-4" tabindex="-1"></a>  <span class="fu">as.character</span>(df<span class="sc">$</span>Date) <span class="sc">%&gt;%</span> </span>
<span id="cb13-5"><a href="the-data.html#cb13-5" tabindex="-1"></a>  <span class="fu">separate</span>(Date, <span class="at">into =</span> <span class="fu">c</span>(<span class="st">&quot;date&quot;</span>, <span class="st">&quot;time&quot;</span>), <span class="at">sep =</span> <span class="st">&quot; (?=[^ ]+$)&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb13-6"><a href="the-data.html#cb13-6" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb13-7"><a href="the-data.html#cb13-7" tabindex="-1"></a>    <span class="at">date =</span> <span class="fu">ymd</span>(<span class="fu">gsub</span>(<span class="st">&quot;/&quot;</span>, <span class="st">&quot;-&quot;</span>, date)),</span>
<span id="cb13-8"><a href="the-data.html#cb13-8" tabindex="-1"></a>    <span class="at">year =</span> <span class="fu">year</span>(date),</span>
<span id="cb13-9"><a href="the-data.html#cb13-9" tabindex="-1"></a>    <span class="at">month =</span> <span class="fu">month</span>(date),</span>
<span id="cb13-10"><a href="the-data.html#cb13-10" tabindex="-1"></a>    <span class="at">day =</span> <span class="fu">day</span>(date)</span>
<span id="cb13-11"><a href="the-data.html#cb13-11" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb13-12"><a href="the-data.html#cb13-12" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>(taxa <span class="sc">==</span> <span class="st">&quot;hoverfly&quot;</span> <span class="sc">&amp;</span> Observer <span class="sc">==</span> <span class="st">&quot;Erica&quot;</span>)) <span class="sc">%&gt;%</span> <span class="co"># remove Erica hoverfly entries </span></span>
<span id="cb13-13"><a href="the-data.html#cb13-13" tabindex="-1"></a>  <span class="fu">unite</span>(collapsed_species, specieslatin<span class="sc">:</span>seaweedlatin, <span class="at">sep =</span> <span class="st">&quot;,&quot;</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb13-14"><a href="the-data.html#cb13-14" tabindex="-1"></a>  <span class="fu">mutate_at</span>(<span class="fu">vars</span>(Species, collapsed_species), na_if, <span class="st">&quot;&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb13-15"><a href="the-data.html#cb13-15" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb13-16"><a href="the-data.html#cb13-16" tabindex="-1"></a>    <span class="at">Species =</span> <span class="fu">coalesce</span>(Species, SpeciesSci, Speciesfull, collapsed_species, species, Other),</span>
<span id="cb13-17"><a href="the-data.html#cb13-17" tabindex="-1"></a>    <span class="at">photoid =</span> <span class="fu">if_else</span>(<span class="fu">is.na</span>(photoid), <span class="cn">NA</span>, <span class="fu">paste0</span>(photoid, <span class="st">&quot;.jpg&quot;</span>)),</span>
<span id="cb13-18"><a href="the-data.html#cb13-18" tabindex="-1"></a>    <span class="at">Count =</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(Count), <span class="dv">1</span>, Count),</span>
<span id="cb13-19"><a href="the-data.html#cb13-19" tabindex="-1"></a>    <span class="at">taxa =</span> <span class="fu">recode</span>(taxa, <span class="at">tree =</span> <span class="st">&quot;Vascular Plants&quot;</span>),</span>
<span id="cb13-20"><a href="the-data.html#cb13-20" tabindex="-1"></a>    <span class="at">year =</span> <span class="fu">recode</span>(year, <span class="st">`</span><span class="at">2023</span><span class="st">`</span> <span class="ot">=</span> <span class="st">&quot;2022/2023&quot;</span>, <span class="st">`</span><span class="at">2022</span><span class="st">`</span> <span class="ot">=</span> <span class="st">&quot;2022/2023&quot;</span>)</span>
<span id="cb13-21"><a href="the-data.html#cb13-21" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb13-22"><a href="the-data.html#cb13-22" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(Species, <span class="st">&quot;(?i)unknown&quot;</span>), taxa <span class="sc">!=</span> <span class="st">&quot;bee&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb13-23"><a href="the-data.html#cb13-23" tabindex="-1"></a>  <span class="fu">filter_at</span>(<span class="fu">vars</span>(taxa, Observer), <span class="fu">all_vars</span>(<span class="sc">!</span><span class="fu">is.na</span>(.))) <span class="sc">%&gt;%</span></span>
<span id="cb13-24"><a href="the-data.html#cb13-24" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb13-25"><a href="the-data.html#cb13-25" tabindex="-1"></a>    <span class="at">taxa =</span> <span class="fu">recode</span>(taxa, </span>
<span id="cb13-26"><a href="the-data.html#cb13-26" tabindex="-1"></a>                  <span class="at">plant =</span> <span class="st">&quot;Vascular Plants&quot;</span>,</span>
<span id="cb13-27"><a href="the-data.html#cb13-27" tabindex="-1"></a>                  <span class="at">bird =</span> <span class="st">&quot;Birds&quot;</span>,</span>
<span id="cb13-28"><a href="the-data.html#cb13-28" tabindex="-1"></a>                  <span class="at">macromoth =</span> <span class="st">&quot;Macromoths&quot;</span>,</span>
<span id="cb13-29"><a href="the-data.html#cb13-29" tabindex="-1"></a>                  <span class="at">micromoth =</span> <span class="st">&quot;Micromoths&quot;</span>,</span>
<span id="cb13-30"><a href="the-data.html#cb13-30" tabindex="-1"></a>                  <span class="at">butterfly =</span> <span class="st">&quot;Butterflies&quot;</span>,</span>
<span id="cb13-31"><a href="the-data.html#cb13-31" tabindex="-1"></a>                  <span class="at">dragonfly =</span> <span class="st">&quot;Dragonflies&quot;</span>,</span>
<span id="cb13-32"><a href="the-data.html#cb13-32" tabindex="-1"></a>                  <span class="at">hoverfly =</span> <span class="st">&quot;Hoverflies&quot;</span>,</span>
<span id="cb13-33"><a href="the-data.html#cb13-33" tabindex="-1"></a>                  <span class="at">bat =</span> <span class="st">&quot;Bats&quot;</span>,</span>
<span id="cb13-34"><a href="the-data.html#cb13-34" tabindex="-1"></a>                  <span class="at">amphibian =</span> <span class="st">&quot;Amphibians&quot;</span>,</span>
<span id="cb13-35"><a href="the-data.html#cb13-35" tabindex="-1"></a>                  <span class="at">reptileamphibian =</span> <span class="st">&quot;Amphibians&quot;</span>,</span>
<span id="cb13-36"><a href="the-data.html#cb13-36" tabindex="-1"></a>                  <span class="at">bumblebee =</span> <span class="st">&quot;Bumblebee&quot;</span>,</span>
<span id="cb13-37"><a href="the-data.html#cb13-37" tabindex="-1"></a>                  <span class="at">mammal =</span> <span class="st">&quot;Mammals&quot;</span>,</span>
<span id="cb13-38"><a href="the-data.html#cb13-38" tabindex="-1"></a>                  <span class="at">ladybird =</span> <span class="st">&quot;Ladybirds&quot;</span>,</span>
<span id="cb13-39"><a href="the-data.html#cb13-39" tabindex="-1"></a>                  <span class="at">tree =</span> <span class="st">&quot;Vascular Plants&quot;</span>),</span>
<span id="cb13-40"><a href="the-data.html#cb13-40" tabindex="-1"></a>    <span class="at">year =</span> <span class="fu">recode</span>(year,</span>
<span id="cb13-41"><a href="the-data.html#cb13-41" tabindex="-1"></a>                  <span class="st">&quot;2023&quot;</span> <span class="ot">=</span> <span class="st">&quot;2022/2023&quot;</span>,</span>
<span id="cb13-42"><a href="the-data.html#cb13-42" tabindex="-1"></a>                  <span class="st">&quot;2022&quot;</span> <span class="ot">=</span> <span class="st">&quot;2022/2023&quot;</span>),</span>
<span id="cb13-43"><a href="the-data.html#cb13-43" tabindex="-1"></a>    <span class="at">Observer =</span> <span class="fu">recode</span>(Observer,</span>
<span id="cb13-44"><a href="the-data.html#cb13-44" tabindex="-1"></a>                      <span class="at">Other1 =</span> <span class="st">&quot;Cori&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb13-45"><a href="the-data.html#cb13-45" tabindex="-1"></a>  <span class="fu">select</span>(Species, SpeciesSci, Count, date, Observer, taxa, photoid, geometry, year, day) <span class="sc">%&gt;%</span></span>
<span id="cb13-46"><a href="the-data.html#cb13-46" tabindex="-1"></a>  <span class="fu">rename</span>(</span>
<span id="cb13-47"><a href="the-data.html#cb13-47" tabindex="-1"></a>    <span class="at">Date =</span> date,</span>
<span id="cb13-48"><a href="the-data.html#cb13-48" tabindex="-1"></a>    <span class="at">Taxa =</span> taxa,</span>
<span id="cb13-49"><a href="the-data.html#cb13-49" tabindex="-1"></a>    <span class="at">PhotoID =</span> photoid</span>
<span id="cb13-50"><a href="the-data.html#cb13-50" tabindex="-1"></a>  )</span></code></pre></div>
<ol start="8" style="list-style-type: decimal">
<li><strong>Merging Tree Data with Cleaned Data</strong>:
<ul>
<li>Prepares the tree data to be merged with the cleaned data.</li>
<li>Merges both datasets.</li>
</ul></li>
</ol>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="the-data.html#cb14-1" tabindex="-1"></a><span class="co"># tree data prep for bind</span></span>
<span id="cb14-2"><a href="the-data.html#cb14-2" tabindex="-1"></a>tree_data <span class="ot">&lt;-</span> tree_data <span class="sc">%&gt;%</span></span>
<span id="cb14-3"><a href="the-data.html#cb14-3" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb14-4"><a href="the-data.html#cb14-4" tabindex="-1"></a>    <span class="at">year =</span> <span class="fu">ifelse</span>(year <span class="sc">==</span> <span class="st">&quot;2023&quot;</span> <span class="sc">|</span> year <span class="sc">==</span> <span class="st">&quot;2022&quot;</span>, <span class="st">&quot;2022/2023&quot;</span>, year),</span>
<span id="cb14-5"><a href="the-data.html#cb14-5" tabindex="-1"></a>    <span class="at">Count =</span> <span class="dv">1</span> <span class="co"># add column count </span></span>
<span id="cb14-6"><a href="the-data.html#cb14-6" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb14-7"><a href="the-data.html#cb14-7" tabindex="-1"></a>  <span class="fu">rename</span>(</span>
<span id="cb14-8"><a href="the-data.html#cb14-8" tabindex="-1"></a>    <span class="at">Date =</span> date,</span>
<span id="cb14-9"><a href="the-data.html#cb14-9" tabindex="-1"></a>    <span class="at">Taxa =</span> taxa</span>
<span id="cb14-10"><a href="the-data.html#cb14-10" tabindex="-1"></a>  )</span>
<span id="cb14-11"><a href="the-data.html#cb14-11" tabindex="-1"></a></span>
<span id="cb14-12"><a href="the-data.html#cb14-12" tabindex="-1"></a><span class="co"># Merge tree data with the cleaned data</span></span>
<span id="cb14-13"><a href="the-data.html#cb14-13" tabindex="-1"></a>all_years <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(taxa_clean, tree_data)</span></code></pre></div>
<ol start="9" style="list-style-type: decimal">
<li><strong>Geometry Processing</strong>:
<ul>
<li>Splits the geometry column into separate latitude and longitude columns.</li>
</ul></li>
</ol>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="the-data.html#cb15-1" tabindex="-1"></a><span class="co"># split into lat and long for mapping </span></span>
<span id="cb15-2"><a href="the-data.html#cb15-2" tabindex="-1"></a>all_years <span class="ot">&lt;-</span> all_years <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">long =</span> <span class="fu">unlist</span>(<span class="fu">map</span>(geometry,<span class="dv">1</span>)),</span>
<span id="cb15-3"><a href="the-data.html#cb15-3" tabindex="-1"></a>           <span class="at">lat =</span> <span class="fu">unlist</span>(<span class="fu">map</span>(geometry,<span class="dv">2</span>)))</span></code></pre></div>
<ol start="10" style="list-style-type: decimal">
<li><strong>Saving the Resulting Data</strong>:
<ul>
<li>Saves the final data frame both as an RData object and as a CSV file.</li>
</ul></li>
</ol>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="the-data.html#cb16-1" tabindex="-1"></a><span class="co"># Save the resulting dataframe</span></span>
<span id="cb16-2"><a href="the-data.html#cb16-2" tabindex="-1"></a><span class="fu">save</span>(all_years, <span class="at">file =</span> <span class="st">&quot;all_years.RData&quot;</span>)</span>
<span id="cb16-3"><a href="the-data.html#cb16-3" tabindex="-1"></a><span class="fu">write.csv</span>(all_years, <span class="at">file =</span> <span class="st">&quot;all_years.csv&quot;</span>)</span></code></pre></div>
</div>
<div id="pulling-photos-and-documents-from-onedrive" class="section level2 hasAnchor" number="3.4">
<h2><span class="header-section-number">3.4</span> Pulling photos and documents from OneDrive<a href="the-data.html#pulling-photos-and-documents-from-onedrive" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="photos" class="section level3 hasAnchor" number="3.4.1">
<h3><span class="header-section-number">3.4.1</span> Photos<a href="the-data.html#photos" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ol style="list-style-type: decimal">
<li><strong>Reading Team Photos from a Directory</strong>:</li>
</ol>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="the-data.html#cb17-1" tabindex="-1"></a>   <span class="co"># read in all photo files within Survey_Photos in OneDrive Folder</span></span>
<span id="cb17-2"><a href="the-data.html#cb17-2" tabindex="-1"></a>   all_Tphotos <span class="ot">&lt;-</span> <span class="fu">list.files</span>(</span>
<span id="cb17-3"><a href="the-data.html#cb17-3" tabindex="-1"></a>     <span class="at">path =</span>   <span class="fu">paste0</span>(path_to_master,<span class="st">&quot;/Team_data&quot;</span>),</span>
<span id="cb17-4"><a href="the-data.html#cb17-4" tabindex="-1"></a>     <span class="at">recursive =</span> <span class="cn">TRUE</span>,</span>
<span id="cb17-5"><a href="the-data.html#cb17-5" tabindex="-1"></a>     <span class="at">pattern =</span> <span class="st">&quot;</span><span class="sc">\\</span><span class="st">.jpg$&quot;</span>,</span>
<span id="cb17-6"><a href="the-data.html#cb17-6" tabindex="-1"></a>     <span class="at">full.names =</span> <span class="cn">FALSE</span></span>
<span id="cb17-7"><a href="the-data.html#cb17-7" tabindex="-1"></a>   )</span></code></pre></div>
<p>This is the same as the first few lines of code, except that the path is constructed by appending “/Team_data” to the <code>path_to_master</code>.</p>
<p>The result is stored in <code>all_Tphotos</code>, which will be a vector of filenames (with “.jpg” extension) from the specified directory and its subdirectories.</p>
<ol start="2" style="list-style-type: decimal">
<li><strong>Constructing a Destination Path for Team Photos</strong>:</li>
</ol>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="the-data.html#cb18-1" tabindex="-1"></a>   www_Tfolder_path <span class="ot">&lt;-</span> <span class="fu">file.path</span>(<span class="fu">getwd</span>(), <span class="st">&quot;www/Team_Data&quot;</span>)</span></code></pre></div>
<p>This line constructs a path by combining the current working directory (obtained using <code>getwd()</code>) with “www/Team_Data”.</p>
<ol start="3" style="list-style-type: decimal">
<li><strong>Copying the Team Photos</strong>:</li>
</ol>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="the-data.html#cb19-1" tabindex="-1"></a>   photo_move <span class="ot">&lt;-</span> <span class="fu">file.copy</span>(</span>
<span id="cb19-2"><a href="the-data.html#cb19-2" tabindex="-1"></a>     <span class="at">from =</span> <span class="fu">file.path</span>(<span class="fu">paste0</span>(path_to_master,<span class="st">&quot;/Team_data&quot;</span>), all_Tphotos),</span>
<span id="cb19-3"><a href="the-data.html#cb19-3" tabindex="-1"></a>     <span class="at">to =</span> <span class="fu">file.path</span>(<span class="fu">paste</span>(www_Tfolder_path), all_Tphotos)</span>
<span id="cb19-4"><a href="the-data.html#cb19-4" tabindex="-1"></a>   )</span></code></pre></div>
<p>Here, <code>file.copy</code> is used to copy files. The <code>from</code> argument constructs the full paths of the source files, and the <code>to</code> argument constructs the full paths of the destination. The photos are copied from the source directory to the destination.</p>
<p>The same process as above is then done for the Survey Photos.</p>
<p>In summary, the code is designed to:</p>
<ul>
<li>Read all “.jpg” files from “Team_data” and “Survey_Photos” directories (including subdirectories).</li>
<li>Copy those files to two new destinations under the “www” folder in the current working directory.</li>
</ul>
</div>
<div id="documents" class="section level3 hasAnchor" number="3.4.2">
<h3><span class="header-section-number">3.4.2</span> Documents<a href="the-data.html#documents" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The code for downloading and saving the students’ about me descriptions is very similar to the process above. The only addition is that the text of the “student_aboutme” word document is then extracted and saved into an object called “student_text”. Then the text is split into paragraphs.</p>
</div>
</div>
<div id="things-to-think-about" class="section level2 hasAnchor" number="3.5">
<h2><span class="header-section-number">3.5</span> Things to think about<a href="the-data.html#things-to-think-about" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>How will the next years data be included? In the same folder? New QGIS folder?</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="files-within-folders-and-folders-within-files-and-more-files.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="ui.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_main.pdf", "_main.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
